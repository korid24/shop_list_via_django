# Shop List
Cервис для создания списков покупок.
Репозиторий с ботом, работающим через этот сервис

#### Возможности:

* Пользователь может авторизоваться в сервисе предоставив пару телеграм_id-пароль и получив в ответе токен
* Пользователь видит только свои списки и покупки.
* Пользователь может создать список или покупку, задав название (по одному или несколько за раз).
* Пользователь может менять менять очередность покупок в списке и очерёдность списков
* Пользователь может менять планируемое время завершения, название и описание
* Пользователь может удалять списки и покупки по одному или несколько за раз.

### Запросы
***

#### Авторизация
```
POST /auth/token/login/
```
Обязательные параметры: <telegram_id>, <password>
Для авторизации необходимо осуществить запрос с логином и паролем действующего пользователя. При корректных данных в ответ будет получен токен, который необходим для дальнейших действий с сервисом, его необходимо будет всталять в заколовки запроса в формате {"Authorization": "Token <полученный_токен>"}

Пример тела запроса:
```
{
    "telegram_id": "777777",
    "password": "password1"
}
```
Пример тела ответа при корректных данных: (status 200)
```
{
    "auth_token": "fa16e8c97ae420bc37!!!!!********a0e"
}
```
***
##### Для выполнения следующих действий необходима авторизация
***
#### Получение всех списков пользователя
```
GET /api/purchaselist/
```
Показывает все списоки пользователя.

Пример тела ответа при корректных данных: (status 200)
```
[
    {
        "ind": 1,
        "title": "Продукты",
        "items": [
            {
                "ind": 1,
                "title": "Кефир",
                "creation_time": "25.08.2020 09:25:14"
            },
            {
                "ind": 2,
                "title": "Шарф",
                "creation_time": "22.10.2020 07:06:59"
            }
        ],
        "creation_time": "24.08.2020 13:19:45",
        "last_change": "07.09.2020 16:11:21"
    },
    {
        "ind": 2,
        "title": "Не продукты",
        "items": [],
        "creation_time": "26.08.2020 10:48:24",
        "last_change": "26.08.2020 10:48:59"
    }
]
```
***
***
#### Создание нового списка
```
POST /api/purchaselist/
```
Обязательные параметры: <title>.
Создаёт новый список для пользователя.

Пример тела запроса:
```
{
	"title": "list for me"
}
```
При корректных данных возвращается статус 201 с информацией о списке.
Пример ответа при некорректных данных(статус 406):

```
{
    "title": [
        "This field is required."
    ]
}
```
***
***
#### Получение списка по его позиции
```
GET /api/purchaselist/<purchase_list_ind>/
```
Показывает показывает конкретный список по ind

Пример тела ответа при корректном ind: (status 200)
```
{
    "ind": 1,
    "title": "Продукты",
    "items": [
        {
            "ind": 1,
            "title": "Кефир",
            "creation_time": "25.08.2020 09:25:14"
        },
        {
            "ind": 2,
            "title": "Шарф",
            "creation_time": "22.10.2020 07:06:59"
        }
    ],
    "creation_time": "24.08.2020 13:19:45",
    "last_change": "07.09.2020 16:11:21"
}
```
Статус 404 означает что списка с таким ind у вас нет.
***
***
#### Смена позиции списка
```
PATCH /api/purchaselist/<purchase_list_ind>/
```
Пример тела запроса:
```
{
    "ind": 2
}
```
Меняет позицию списка
При успешном обновлении вернёт статус 200 с обновлённой информацией о списке.
При ошибке в переданных данных вернёт статус 400 со списком ошибок в теле
Статус 404 означает что списка с таким ind у вас нет
***
***
#### Удаление списка по ind
```
DELETE /api/purchaselist/<purchase_list_ind>/
```
Удаляет список по ind
Возвращает код 204 при успешном удалении
Возвращает код 404 если списка с таким ind у вас нет
***
***
#### Создание нескольких списков за раз
```
POST /api/purchaselist/bulk_create/
```
Обязательные параметры: <title>.
Создаёт новую задачу для пользователя.

Пример тела запроса:
```
[
    {
    	"title": "list for me"
    },
    {
    	"title": "another list for me"
    },
    {
    	"title": "one more list for me"
    }
]
```

Пример ответа при корректных данных(статус 201):
```
[
    {
        "ind": 3,
        "title": "list for me",
        "items": [],
        "creation_time": "22.10.2020 09:36:32",
        "last_change": "22.10.2020 09:36:32"
    },
    {
        "ind": 4,
        "title": "another list for me",
        "items": [],
        "creation_time": "22.10.2020 09:36:32",
        "last_change": "22.10.2020 09:36:32"
    },
    {
        "ind": 5,
        "title": "one more list for me",
        "items": [],
        "creation_time": "22.10.2020 09:36:33",
        "last_change": "22.10.2020 09:36:33"
    }
```
Пример ответа при некорректных данных(статус 400):

```
{
    "Error": "A list with values was expected"
}
```
***
***
#### Удаление нескольких списков
```
DELETE /api/purchaselist/bulk_delete/
```
Удаляет несколько списоков по ind
Пример запроса:
```
{
	"items": [2, 5]
}
```
Возвращает код 204 при успешном удалении
Пример ответа при некорректных данных(статус 400):
```
{
    "items": "A list with integers was expected"
}
```
***
Аналогично проводятся операции и с покупками.
Примеры запросов на операции с покупками:
```
GET /api/purchaselist/<purchase_list_ind>/purchase/ # получение всех покупок из списка с ind, равным purchase_list_ind
```
```
POST /api/purchaselist/<purchase_list_ind>/purchase/ # создание новой покупки в списке с ind, равным purchase_list_ind
```
```
GET /api/purchaselist/<purchase_list_ind>/purchase/<purchase_ind>/ # коктретая задача с ind == purchase_ind, в списке ind == purchase_list_ind
```
```
PATCH /api/purchaselist/<purchase_list_ind>/purchase/<purchase_ind>/ # смена позиции задачи с ind == purchase_ind, в списке ind == purchase_list_ind
```
```
DELETE /api/purchaselist/<purchase_list_ind>/purchase/<purchase_ind> # удаление задачи с ind == purchase_ind, в списке ind == purchase_list_ind
```
```
POST /api/purchaselist/<purchase_list_ind>/purchase/bulk_create/ # создание нескольких задач в списке в списке ind == purchase_list_ind
```
```
DELETE /api/purchaselist/<purchase_list_ind>/purchase/bulk_delete/ # удаление нескольких задач в списке в списке ind == purchase_list_ind
```
